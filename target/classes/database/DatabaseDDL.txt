

drop table discussion_upload_file;
drop table profile_img;
drop table recent_post_D;
drop table recent_post_T;
drop table posts;
drop table topics;
drop table discussion;
drop table member;
drop table category;


create table member
(
    id         number primary key,
    username   varchar(50) unique not null,
    password   varchar(50)        not null,
    email      varchar(50) unique not null,
    joined     timestamp default sysdate,
    post_count number    default 0,
    last_visit timestamp          null
);

CREATE TABLE category
(
    id    number primary key,
    title varchar(200) unique not null
);


create table discussion
(
    id               number primary key,
    title            varchar(200) unique not null,
    description      varchar(200)        null,
    category_id      number references category (id),
    total_post_count number default 0
);


create table topics
(
    id             number primary key,
    title          varchar(200) unique not null,
    writer         number references member (id),
    write_date     TIMESTAMP default sysdate,
    reply_number   number    default 0,
    view_count     number    default 0,
    discussion_id  number references discussion (id),
    recent_post_id number,
    post_count     number
);

create table posts
(
    id                number primary key,
    content           clob   not null,
    writer            number references member (id),
    edited            timestamp default sysdate,
    react_like        number    default 0,
    react_agree       number    default 0,
    react_informative number    default 0,
    react_total_count number    default 0,
    reply_step        number null,
    topic_id          number references topics (id),
    discussion_id     number not null
);


create table recent_post_D
(
    id            number primary key,
    member_id     number                            not null,
    post_id       number                            not null,
    topic_title   varchar(200)                      not null,
    discussion_id number references discussion (id) not null,
    time          timestamp default sysdate
);

create table recent_post_t
(
    id        number primary key,
    topics_id number references topics (id) not null,
    time      timestamp default sysdate
);


create table profile_img
(
    id                number primary key,
    file_name         varchar(235) not null,
    file_size         varchar(45)  not null,
    file_content_type varchar(500) not null,
    file_data         blob         not null,
    upload_date       Timestamp default sysdate,
    member_id         number       not null
);

create table discussion_upload_file
(
    id                number primary key,
    discussion_id     number references discussion (id),
    file_name         varchar(235) not null,
    file_size         varchar(45)  not null,
    file_content_type varchar(500) not null,
    file_data         blob         not null,
    uploader          number references member (id)
);

